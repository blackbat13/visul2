class Animation{colors={sorted:"#ffd700",normal:"#29B6F6",first:"#43A047",second:"#D32F2F"};constructor(){this.array=[],this.$visulContainer=$("#visul-container"),this.blockWidth=50,this.arrayBlocks=[],this.timeLine=null,this.$timeRange=$("#time-range"),this.$startButton=$("#start-button"),this.$restartButton=$("#restart-button"),this.$pauseButton=$("#pause-button")}bindControls(){this.$startButton.click(function(){this.timeLine.play(),this.activateButton(this.$startButton),this.deactivateButton(this.$pauseButton)}.bind(this)),this.$restartButton.click(function(){this.timeLine.restart(),this.activateButton(this.$startButton),this.deactivateButton(this.$pauseButton)}.bind(this)),this.$pauseButton.click(function(){this.timeLine.pause(),this.activateButton(this.$pauseButton),this.deactivateButton(this.$startButton)}.bind(this)),this.$timeRange.on("input",function(){this.timeLine.seek(this.timeLine.duration*(this.$timeRange.val()/100))}.bind(this)),this.$timeRange.val(0),this.activateButton(this.$pauseButton)}activateButton(t){anime({targets:"#"+t.attr("id"),backgroundColor:"#ffca2c",borderColor:"ffca2c",color:"#000",duration:200})}deactivateButton(t){anime({targets:"#"+t.attr("id"),backgroundColor:"#0d6efd",borderColor:"#0d6efd",color:"#fff",duration:200})}loadOrPrepareArray(){let t=new URLSearchParams(decodeURIComponent(window.location.hash.substr(1)));t.has("array")?this.array=JSON.parse(t.get("array")):this.prepareRandomArray(10)}prepareRandomOrder(t){this.array=[];for(let a=1;a<=t;a++)this.array.push(a);this.array=_.shuffle(this.array)}prepareReverseOrder(t){this.array=[];for(let a=t;a>=1;a--)this.array.push(a)}prepareRandomArray(t){this.array=[];for(let a=0;a<t;a++)this.array.push(Math.floor(15*Math.random())+1)}showArray(){let t=this.$visulContainer.width(),a=Math.floor((t-this.array.length*this.blockWidth)/2);this.firstLeft=a,this.$visulContainer.empty(),this.arrayBlocks=[];for(let t=0;t<this.array.length;t++)this.arrayBlocks.push(this.prepareSortingBlock(this.array[t],a,t)),this.$visulContainer.append(this.arrayBlocks[t]),a+=this.blockWidth;let r={array:JSON.stringify(this.array)};window.location.hash=$.param(r),this.activateButton(this.$pauseButton),this.deactivateButton(this.$startButton)}prepareSortingBlock(t,a,r){let i=$("<div></div>");return i.addClass("sorting-block"),i.css("height",(25*t).toString()+"px"),i.css("width",this.blockWidth.toString()+"px"),i.css("left",a.toString()+"px"),i.attr("id","sorting-block-"+r.toString()),i.attr("s-color",this.colors.normal),i.css("background-color",this.colors.normal),i.append(this.prepareSortingNumber(t)),i}prepareSortingNumber(t){let a=$("<span></span>");return a.addClass("sorting-number"),a.text(t.toString()),a}animateCompare(t,a){this.timeLine.add({targets:"#"+this.arrayBlocks[t].attr("id"),backgroundColor:this.colors.first,easing:"easeInOutQuad"}),this.timeLine.add({targets:"#"+this.arrayBlocks[a].attr("id"),backgroundColor:this.colors.second,easing:"easeInOutQuad"},"-=750")}animateSwap(t,a){this.timeLine.add({targets:"#"+this.arrayBlocks[t].attr("id"),left:this.firstLeft+a*this.blockWidth,easing:"easeInOutQuad"}),this.timeLine.add({targets:"#"+this.arrayBlocks[a].attr("id"),left:this.firstLeft+t*this.blockWidth,easing:"easeInOutQuad"},"-=750"),[this.array[t],this.array[a]]=[this.array[a],this.array[t]],[this.arrayBlocks[t],this.arrayBlocks[a]]=[this.arrayBlocks[a],this.arrayBlocks[t]]}animateLeave(t){this.timeLine.add({targets:"#"+this.arrayBlocks[t[0]].attr("id"),backgroundColor:this.arrayBlocks[t[0]].attr("s-color"),easing:"easeInOutQuad"});for(let a=1;a<t.length;a++)this.timeLine.add({targets:"#"+this.arrayBlocks[t[a]].attr("id"),backgroundColor:this.arrayBlocks[t[a]].attr("s-color"),easing:"easeInOutQuad"},"-=750")}animateMark(t,a){this.timeLine.add({targets:"#"+this.arrayBlocks[t[0]].attr("id"),backgroundColor:a[0],easing:"easeInOutQuad"});for(let r=1;r<t.length;r++)this.timeLine.add({targets:"#"+this.arrayBlocks[t[r]].attr("id"),backgroundColor:a[r],easing:"easeInOutQuad"},"-=750")}animateMarkSorted(t){this.timeLine.add({targets:"#"+this.arrayBlocks[t].attr("id"),backgroundColor:this.colors.sorted,easing:"easeInOutQuad"}),this.arrayBlocks[t].attr("s-color",this.colors.sorted)}animateMarkSortedAll(){for(let t=0;t<this.array.length;t++)this.animateMarkSorted(t)}}
class Sorting extends Animation{constructor(){super()}prepareInsertionSort(){this.timeLine=anime.timeline({easing:"easeOutExpo",duration:750,update:function(t){this.$timeRange.val(this.timeLine.progress)}.bind(this)}),this.animateMarkSorted(0);for(let t=0;t<this.array.length-1;t++){let i=t+1;for(this.animateMark([i],[this.colors.second]);i>0&&this.array[i]<this.array[i-1];)this.animateMark([i-1],[this.colors.first]),this.animateSwap(i,i-1),this.animateLeave([i]),i--;i>0&&(this.animateMark([i-1],[this.colors.first]),this.animateLeave([i-1])),this.animateMarkSorted(i)}this.timeLine.restart(),this.timeLine.pause()}prepareBubbleSort(){this.timeLine=anime.timeline({easing:"easeOutExpo",duration:750,update:function(t){this.$timeRange.val(this.timeLine.progress)}.bind(this)});for(let t=0;t<this.array.length;t++){for(let i=0;i<this.array.length-t-1;i++)this.animateCompare(i,i+1),this.array[i]>this.array[i+1]&&this.animateSwap(i,i+1),this.animateLeave([i,i+1]);this.animateMarkSorted(this.arrayBlocks.length-t-1)}this.timeLine.restart(),this.timeLine.pause()}prepareSelectionSort(){this.timeLine=anime.timeline({easing:"easeOutExpo",duration:750,update:function(t){this.$timeRange.val(this.timeLine.progress)}.bind(this)});for(let t=0;t<this.array.length-1;t++){let i=this.array[t],e=t;this.animateMark([t],[this.colors.second]);for(let a=t+1;a<this.array.length;a++)this.animateMark([a],[this.colors.first]),this.array[a]<i?(this.animateLeave([e]),this.animateMark([a],[this.colors.second]),i=this.array[a],e=a):this.animateLeave([a]);e!==t&&this.animateSwap(t,e),this.animateMarkSorted(t)}this.animateMarkSorted(this.array.length-1),this.timeLine.restart(),this.timeLine.pause()}prepareGnomeSort(){this.timeLine=anime.timeline({easing:"easeOutExpo",duration:750,update:function(t){this.$timeRange.val(this.timeLine.progress)}.bind(this)});let t=0;for(this.animateMark([t],[this.colors.second]);t<this.array.length;)0===t||this.array[t]>=this.array[t-1]?(this.animateLeave([t]),t+=1,t<this.array.length&&this.animateMark([t],[this.colors.second])):(this.animateSwap(t,t-1),t-=1);this.animateMarkSortedAll(),this.timeLine.restart(),this.timeLine.pause()}prepareCocktailShakerSort(){this.timeLine=anime.timeline({easing:"easeOutExpo",duration:750,update:function(t){this.$timeRange.val(this.timeLine.progress)}.bind(this)});for(let t=0;t<=this.array.length/2;t++){for(let i=t;i<this.array.length-t-1;i++)this.animateCompare(i,i+1),this.array[i]>this.array[i+1]&&this.animateSwap(i,i+1),this.animateLeave([i,i+1]);this.animateMarkSorted(this.array.length-t-1);for(let i=this.array.length-t-2;i>t;i--)this.animateCompare(i,i-1),this.array[i]<this.array[i-1]&&this.animateSwap(i,i-1),this.animateLeave([i,i-1]);this.animateMarkSorted(t)}this.timeLine.restart(),this.timeLine.pause()}prepareCombSort(){this.timeLine=anime.timeline({easing:"easeOutExpo",duration:750,update:function(t){this.$timeRange.val(this.timeLine.progress)}.bind(this)});let t=this.array.length,i=!1;for(;!i;){t=Math.floor(t/1.3),t<=1&&(t=1,i=!0);let e=0;for(;e+t<this.array.length;)this.animateCompare(e,e+t),this.array[e]>this.array[e+t]&&(this.animateSwap(e,e+t),i=!1),this.animateLeave([e,e+t]),e++}this.animateMarkSortedAll(),this.timeLine.restart(),this.timeLine.pause()}prepareOddEvenSort(){this.timeLine=anime.timeline({easing:"easeOutExpo",duration:750,update:function(t){this.$timeRange.val(this.timeLine.progress)}.bind(this)});let t=!1;for(;!t;){t=!0;for(let i=1;i<this.array.length-1;i+=2)this.animateCompare(i,i+1),this.array[i]>this.array[i+1]&&(this.animateSwap(i,i+1),t=!1),this.animateLeave([i,i+1]);for(let i=0;i<this.array.length-1;i+=2)this.animateCompare(i,i+1),this.array[i]>this.array[i+1]&&(this.animateSwap(i,i+1),t=!1),this.animateLeave([i,i+1])}this.animateMarkSortedAll(),this.timeLine.restart(),this.timeLine.pause()}}
class Searching extends Animation{constructor(){super()}prepareFindMin(){this.timeLine=anime.timeline({easing:"easeOutExpo",duration:750,update:function(i){this.$timeRange.val(this.timeLine.progress)}.bind(this)});let i=this.array[0],t=0;this.animateMark([0],[this.colors.second]);for(let e=1;e<this.array.length;e++)this.animateMark([e],[this.colors.first]),this.array[e]<i?(this.animateLeave([t]),this.animateMark([e],[this.colors.second]),i=this.array[e],t=e):this.animateLeave([e]);this.animateMarkSorted(t),this.timeLine.restart(),this.timeLine.pause()}prepareFindMax(){this.timeLine=anime.timeline({easing:"easeOutExpo",duration:750,update:function(i){this.$timeRange.val(this.timeLine.progress)}.bind(this)});let i=this.array[0],t=0;this.animateMark([0],[this.colors.second]);for(let e=1;e<this.array.length;e++)this.animateMark([e],[this.colors.first]),this.array[e]>i?(this.animateLeave([t]),this.animateMark([e],[this.colors.second]),i=this.array[e],t=e):this.animateLeave([e]);this.animateMarkSorted(t),this.timeLine.restart(),this.timeLine.pause()}}
class Trees extends Animation{constructor(){super()}prepareSortingBlock(t,i,s){let e=$("<div></div>");return e.addClass("sorting-block"),e.css("height",this.blockWidth.toString()+"px"),e.css("width",this.blockWidth.toString()+"px"),e.css("left",i.toString()+"px"),e.attr("id","sorting-block-"+s.toString()),e.attr("s-color",this.colors.normal),e.css("background-color",this.colors.normal),e.append(this.prepareSortingNumber(t)),e}prepareBuildBinaryTree(){this.timeLine=anime.timeline({easing:"easeOutExpo",duration:750,update:function(t){this.$timeRange.val(this.timeLine.progress)}.bind(this)});let t=Math.ceil(Math.log2(this.array.length)),i=Math.pow(2,t),s=this.$visulContainer.width(),e=i*this.blockWidth,r=(this.$visulContainer.height()-this.blockWidth)/t,o=Math.floor((s-e)/2),a=[];for(let t=0;t<this.array.length;t++){a.push(this.array[t]);let i=Math.floor(Math.log2(a.length))+1,s=a.length-Math.pow(2,i-1),n=e/Math.pow(2,i)+s*(e/Math.pow(2,i-1))+o-this.blockWidth/2,h=i*r,l=Math.floor((t-1)/2);this.timeLine.add({targets:"#"+this.arrayBlocks[t].attr("id"),backgroundColor:this.colors.normal,left:n.toString()+"px",top:h.toString()+"px",borderRadius:["0%","50%"],easing:"linear",complete:function(i){l>=0&&this.addEdge(this.arrayBlocks[t],this.arrayBlocks[l],t)}.bind(this)}),l>=0&&this.timeLine.add({targets:"#line-"+t.toString(),x2:5})}this.timeLine.restart(),this.timeLine.pause()}addEdge(t,i,s){let e=parseInt(t.css("left")),r=parseInt(i.css("left")),o=parseInt(t.css("top")),a=parseInt(i.css("top")),n=Math.min(e,r)+this.blockWidth/2,h=Math.max(e,r)-n+this.blockWidth/2,l=Math.min(o,a)+this.blockWidth,d=Math.max(o,a)-l,p=$("<div></div>");if(e>r){p.addClass("edge");let t=$("<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 10 10'></svg>"),i=$("<line x1='0' y1='0' x2='10' y2='10' />");i.css("stroke","#000"),i.css("stroke-width",1),i.attr("id","line-"+s.toString()),t.append(i),p.append(t)}else p.addClass("edger");p.css("left",n.toString()+"px"),p.css("top",l.toString()+"px"),p.css("width",h.toString()+"px"),p.css("height",d.toString()+"px"),p.attr("id","edge-"+s.toString()),this.$visulContainer.append(p)}}
